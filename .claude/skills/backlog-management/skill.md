# Backlog Management Skill

You are assisting with backlog management operations. This skill provides workflows for managing product tickets in the `.claude/backlog/` directory.

## Folder Structure

The backlog uses the following folder structure:
- `0_Done/` - Completed tickets
- `1_WIP/` - Work in progress tickets
- `2_To_Do/` - Tickets ready to be worked on
- `3_To_Plan/` - Tickets that need planning
- `4_Wait/` - Tickets on hold
- `5_Archive/` - Archived tickets

## Available Workflows

### 1. Initialize Backlog

Create the backlog folder structure if it doesn't exist yet.

**Steps:**
1. Check if `.claude/backlog/` exists
2. Create the following folders if they don't exist:
   - `0_Done/`
   - `1_WIP/`
   - `2_To_Do/`
   - `3_To_Plan/`
   - `4_Wait/`
   - `5_Archive/`

### 2. Prepare Ticket

Convert a raw note or request into a structured ticket.

**Steps:**
1. **Ask clarifying questions** to fully understand the requirements before creating the ticket
2. Scan all existing tickets in `.claude/backlog/` to determine the next ticket ID
3. Assign a 4-digit zero-padded ticket ID (e.g., 0001, 0002, 0010, 0100)
4. Gather required information from the user:
   - **Epic**: Ask user which epic this belongs to
   - **Title**: Clear, concise ticket name
   - **Summary**: Brief description
   - **Type**: Ask user to confirm (Feature, Bug, Improvement)
   - **Priority**: Ask user to confirm (Low, Medium, High, Critical) - default: Medium
   - **Sprint**: Ask if this should be assigned to a sprint
   - **User Story**: Detailed description in user story format
   - **Acceptance Criteria**: List what "done" looks like
   - **Initial Request**: Capture the original request verbatim
5. Load the template from `.claude/skills/backlog-management/templates/ticket-template.md`
6. Replace all placeholders:
   - `{{TICKET_ID}}`: The assigned ticket ID
   - `{{EPIC}}`: Epic name
   - `{{TITLE}}`: Ticket title
   - `{{TYPE}}`: Feature/Bug/Improvement
   - `{{STATUS}}`: Initial status (usually "1_WIP")
   - `{{CREATED_DATE}}`: Current date in ISO format (YYYY-MM-DD)
   - `{{UPDATED_DATE}}`: Current date in ISO format (YYYY-MM-DD)
   - `{{PRIORITY}}`: Low/Medium/High/Critical
   - `{{SPRINT}}`: Sprint name or empty
   - `{{SUMMARY}}`: Brief summary
   - `{{USER_STORY}}`: User story description
   - `{{ACCEPTANCE_CRITERIA}}`: Bullet list of acceptance criteria
   - `{{INITIAL_REQUEST}}`: Original request text
7. Create the ticket file in `.claude/backlog/1_WIP/` with filename: `{TICKET_ID}_{TYPE}_{Title_Snake_Case}.md`
8. **Validate epic** if the ticket has an epic assigned:
   - Check that epic file exists in `.claude/epics/{Epic_Name_Snake_Case}.md`
   - If epic doesn't exist, **warn the user** and offer to create it
   - Note: Epic's "Related Tickets" section is dynamically generated by scanning backlog, not manually maintained
9. **Delete the original note file** if the ticket was created from a note in `2_To_Do/` or any other folder

### 3. Update Ticket

Update fields in an existing ticket.

**Steps:**
1. **Ask clarifying questions** to understand what needs to be updated and why
2. Locate the ticket file
3. Read the current ticket content
4. Ask user what fields to update
5. Update the frontmatter and/or content sections as needed
6. Update the `Updated` date to current date
7. If status changed, move the file to the appropriate folder
8. **Validate epic** if epic field was added or changed:
   - Check that epic file exists in `.claude/epics/`
   - If epic doesn't exist, **warn the user** and offer to create it
   - Note: Epic's "Related Tickets" section is dynamically generated, no manual update needed

### 4. Close Ticket

Mark a ticket as complete and move it to the Done folder.

**Steps:**
1. **Locate the ticket**
   - Find ticket by ID or filename in `.claude/backlog/`
   - Determine current folder location
   - Read current ticket content

2. **Verify ticket is ready to close**
   - Check that acceptance criteria are met (optional but recommended)
   - Confirm implementation is complete
   - Verify development log exists (if applicable)

3. **Update ticket metadata**
   - Update `Status` field to `0_Done`
   - Update `Updated` date to current date in ISO format (YYYY-MM-DD)
   - Preserve all other fields and content

4. **Move ticket to Done folder**
   - Move ticket file from current location to `.claude/backlog/0_Done/`
   - Maintain same filename
   - Verify the move was successful

5. **Confirm closure**
   - Verify ticket now exists in `0_Done/` folder
   - Confirm ticket no longer exists in original location
   - Report completion to user
   - Note: Epic's "Related Tickets" section is dynamically generated, no manual update needed

### 5. Create Epic

Create a new epic to group related tickets under a strategic theme.

**Steps:**
1. **Ask clarifying questions** to understand the epic's purpose and scope
2. Check if epic already exists in `.claude/epics/` directory
3. Gather required information from the user:
   - **Epic Name**: Clear, descriptive name for the epic
   - **Description**: Detailed explanation of the epic's purpose and scope
4. Load the template from `.claude/skills/backlog-management/templates/epic-template.md`
5. Replace all placeholders:
   - `{{EPIC_NAME}}`: The epic name
   - `{{CREATED_DATE}}`: Current date in ISO format (YYYY-MM-DD)
   - `{{UPDATED_DATE}}`: Current date in ISO format (YYYY-MM-DD)
   - `{{DESCRIPTION}}`: Epic description
   - `{{RELATED_TICKETS}}`: Leave empty (this section is dynamically populated when viewing the epic)
6. Create the epic file in `.claude/epics/` with filename: `{Epic_Name_Snake_Case}.md`
7. Confirm epic creation to user

### 6. Update Epic

Update an existing epic's metadata or description.

**Steps:**
1. **Ask clarifying questions** to understand what needs to be updated
2. Locate the epic file in `.claude/epics/`
3. Read the current epic content
4. Ask user what fields to update (Name, Description, or Related Tickets)
5. Update the requested fields
6. Update the `Updated` date to current date in ISO format (YYYY-MM-DD)
7. If epic name changed, rename the file to match new name in snake_case
8. Confirm update to user

### 7. Delete Epic

Remove an epic from the system.

**Steps:**
1. **Ask for confirmation** before deleting
2. Locate the epic file in `.claude/epics/`
3. Read the epic to check for associated tickets
4. If epic has related tickets, **warn the user** and ask for confirmation
   - Option 1: Proceed with deletion (tickets will have orphaned epic references)
   - Option 2: Cancel deletion
5. If user confirms, delete the epic file
6. Confirm deletion to user
7. **Recommend**: Update tickets that referenced this epic to remove/change epic field

### 8. List Epics

Display all existing epics with summary information.

**Steps:**
1. Scan `.claude/epics/` directory for all `.md` files
2. Read each epic file to extract metadata
3. For each epic, gather:
   - Epic Name
   - Description (first 100 characters or full if shorter)
   - Number of related tickets
   - Created date
   - Updated date
4. Display epics in a formatted list or table
5. Optionally sort by name, date, or ticket count (ask user preference)

### 9. List Tickets by Epic

Show all tickets associated with a specific epic by dynamically scanning the backlog.

**Steps:**
1. Ask user which epic to view (or provide epic name as parameter)
2. Locate the epic file in `.claude/epics/` and read it to get the epic name
3. **Scan all backlog folders** (0_Done, 1_WIP, 2_To_Do, 3_To_Plan, 4_Wait, 5_Archive) for ticket files
4. For each ticket file:
   - Read the frontmatter to check the `Epic` field
   - If `Epic` matches the target epic name, include it in the results
5. Display the list of matching tickets with:
   - Ticket ID
   - Title
   - Status (based on which folder the ticket is in)
   - Priority
   - Clickable link to ticket file (format: `.claude/backlog/{folder}/{filename}.md`)
6. If no tickets match the epic, inform user
7. Optionally sort by status, priority, or ticket ID

## Important Notes

- Always **ask clarifying questions** before creating or updating tickets/epics to ensure full understanding
- Ticket IDs are unique and incremental across the entire backlog
- Epic names should be descriptive and use Title Case (converted to snake_case for filenames)
- Use consistent naming:
  - Tickets: `{TICKET_ID}_{TYPE}_{Title_Snake_Case}.md`
  - Epics: `{Epic_Name_Snake_Case}.md`
- When updating tickets or epics, preserve all existing information unless explicitly asked to change it
- Status field should always match the folder location for tickets
- All dates should be in ISO format (YYYY-MM-DD)
- When a ticket references an epic, that epic must exist in `.claude/epics/`
- **Epic-Ticket Relationship**: The relationship is defined by the `Epic` field in ticket frontmatter. Epic files do NOT manually track tickets - the "Related Tickets" are dynamically discovered by scanning all tickets in the backlog where the `Epic` field matches the epic name
